2024/08/26 19:36:46 __main__: problem: cvrp
graph_size: 200
coords_dist: explosion
weights_dist: random_int
out_name: ${problem}_${graph_size}_${coords_dist}
data_file_path: data/test_data/${problem}/${coords_dist}/${problem}${graph_size}/val_E_size2000.pkl
normalize_data: false
checkpoint_load_path: models/BQ/bq_nco/pretrained_models/cvrp.best
env_kwargs:
  generator_args:
    coords_sampling_dist: ${coords_dist}
    weights_sampling_dist: random_int
    normalize_demands: false
    single_large_instance: null
  sampling_args:
    sample_size: 64
    graph_size: ${graph_size}
    subsample: false
    k: 16
    cap: 50
    max_cap_factor: null
    n_depots: 1
model: BQ
model_cfg:
  dim_emb: 192
  dim_ff: 512
  nb_layers_encoder: 9
  nb_heads: 12
  dropout: 0.0
  batchnorm: false
  activation_ff: relu
  activation_attention: softmax
run_type: val
number_runs: 3
debug_lvl: 0
global_seed: 1234
cuda: true
G3DMark: 17177
G2DMark: 975
CPU_Mark_single: 2714
CPU_Mark: 11980
number_threads: 12
number_cpus: 6
test_cfg:
  eval_type:
  - pi
  - wrap
  time_limit: 480
  save_solutions: true
  save_for_analysis: true
  saved_res_dir: outputs/saved_results
  out_name: ${out_name}
  save_trajectory: true
  save_traj_for: null
  fixed_dataset: true
  data_file_path: ${data_file_path}
  dataset_range: null
  dataset_size: 128
  checkpoint_load_path: ${checkpoint_load_path}
  beam: 1
  eval_batch_size: 1
  add_ls: true
  ls_policy_cfg:
    local_search_strategy: SIMULATED_ANNEALING
    solution_limit: null
    verbose: false
    log_search: false
    batch_size: 8
    search_workers: 1
eval_opts_cfg:
  test_only: true
  knns: -1
  beam_size: ${test_cfg.beam}
  val_batch_size: ${test_cfg.eval_batch_size}
  test_batch_size: ${test_cfg.eval_batch_size}
  val_dataset: null
  train_dataset: null
  test_dataset: None
  debug: null
  output_dir: null
log_lvl: INFO
tb_log_path: logs/tb/
log_path: logs/
checkpoint_save_path: checkpoints/

2024/08/26 19:36:46 models.runner_utils: torch.cuda.is_available() True
2024/08/26 19:36:46 models.runner_utils: cfg.cuda True
2024/08/26 19:36:46 models.runner_utils: Running val-run on cuda
2024/08/26 19:36:46 models.runner_utils: CPU Specs: cpu_name: Intel(R) Xeon(R) CPU E5-1660 v4 @ 3.20GHz, threads_per_cpu: 2, total_cores: 8
2024/08/26 19:36:46 models.runner_utils: GPU Device Name: NVIDIA GeForce GTX 1080 Ti
2024/08/26 19:36:46 models.runners: Eval PassMark for this run: 5956. Adjusted Time Limit per Instance for Construction: 410.0. PassMark for additional GORT Search: 2187. Adjusted Time Limit per Instance for Search : 439.0.
2024/08/26 19:36:46 data.base_dataset: Test Data provided: /home/thyssens/RA/routing-arena/data/test_data/cvrp/explosion/cvrp200/val_E_size2000.pkl, No new samples are generated.
2024/08/26 19:36:46 data.base_dataset: BKS file should exists for /home/thyssens/RA/routing-arena/data/test_data/cvrp/explosion/cvrp200/val_E_size2000.pkl
2024/08/26 19:36:46 data.base_dataset: Loading Best Known Solutions from /home/thyssens/RA/routing-arena/data/test_data/cvrp/explosion/cvrp200/BKS_val.pkl
2024/08/26 19:36:46 data.base_dataset: BaseSol file should exists for /home/thyssens/RA/routing-arena/data/test_data/cvrp/explosion/cvrp200/val_E_size2000.pkl
2024/08/26 19:36:46 data.base_dataset: Loading Base Solver Results (for WRAP eval.) from /home/thyssens/RA/routing-arena/data/test_data/cvrp/explosion/cvrp200/BaseSol_val.pkl
2024/08/26 19:36:46 data.base_dataset: Tried to load Base Solutions, but do not exists... No WRAP eval. possible.
2024/08/26 19:36:46 data.base_dataset: Loaded 2000 BKS for the test (val) set.
2024/08/26 19:36:46 data.base_dataset: Loading dataset from: /home/thyssens/RA/routing-arena/data/test_data/cvrp/explosion/cvrp200/val_E_size2000.pkl
2024/08/26 19:36:47 data.cvrp_dataset: 128 CVRP Test/Validation Instances for cvrp with 200 explosion-distributed customers loaded.
2024/08/26 19:36:47 data.cvrp_dataset: Transforming instances from lists to CVRPInstances
2024/08/26 19:36:48 metrics.metrics: Base Reference for this machine in metrics initialisation set to 2000
2024/08/26 19:36:48 metrics.metrics: Base Reference for first GPU constructed method set to 4974
2024/08/26 19:36:48 models.runners: Parallelize local search runs: running 8 instances in parallel.
2024/08/26 19:36:48 models.runners: running inference 1/3...
2024/08/26 19:36:48 models.runners: Run-time dependent parameters: cuda Device (threads: 8), Adjusted Time Budget for construction: 410.0 / instance. Adjusted Time Budget for LS: 439.0 / instance.
2024/08/26 19:36:48 models.runners: running test inference for BQ_greedy with additional LS: SA...
2024/08/26 19:39:36 models.runners: Constructed solutions with average cost 19.957144908607006 in 1.3120486307889223/inst
2024/08/26 19:39:36 models.runners: 
 finished construction... starting LS
2024/08/26 19:39:36 models.or_tools.or_tools: Working with original capacity and demand
2024/08/26 19:39:52 models.or_tools.or_tools: Local Search has remaining 437.6879513692111 seconds per instance.
2024/08/26 21:36:42 models.runners: Starting Evaluation for run 1/3 with time limit 480 for BQ_greedy_SA
2024/08/26 21:36:43 data.base_dataset: Saving solution trajectory for instance 0
2024/08/26 21:37:19 models.runner_utils: Stats for run 1/3:
2024/08/26 21:37:19 models.runner_utils: =================================
2024/08/26 21:37:19 models.runner_utils: 
Instance 0 Cost: 17.488182973282505, 
Instance 0 Method Internal-Cost: 17.728832244873047, 
Instance 0 PI: 3.5303351266466, 
Instance 0 WRAP: None, 
Instance 0 Run Time (best sol found): 14.711744025349617, 
Instance 0 Run Time (total): 439.3361316472292
2024/08/26 21:37:19 models.runner_utils: 
Instance 1 Cost: 23.204663815641336, 
Instance 1 Method Internal-Cost: 23.3670597076416, 
Instance 1 PI: 2.0952372830784993, 
Instance 1 WRAP: None, 
Instance 1 Run Time (best sol found): 6.640188697725534, 
Instance 1 Run Time (total): 439.3293573167175
2024/08/26 21:37:19 models.runner_utils: 
Instance 2 Cost: 22.505101531100568, 
Instance 2 Method Internal-Cost: 22.657604217529297, 
Instance 2 PI: 1.0537048187475584, 
Instance 2 WRAP: None, 
Instance 2 Run Time (best sol found): 4.4611565712839365, 
Instance 2 Run Time (total): 439.3360537737608
2024/08/26 21:37:19 models.runner_utils: 
Instance 3 Cost: 22.154942061320696, 
Instance 3 Method Internal-Cost: 22.333023071289062, 
Instance 3 PI: 1.8983974202025022, 
Instance 3 WRAP: None, 
Instance 3 Run Time (best sol found): 7.177005244418979, 
Instance 3 Run Time (total): 439.3365056794137
2024/08/26 21:37:19 models.runner_utils: 
Instance 4 Cost: 17.18219963267425, 
Instance 4 Method Internal-Cost: 17.19955062866211, 
Instance 4 PI: 1.4041429840993658, 
Instance 4 WRAP: None, 
Instance 4 Run Time (best sol found): 5.878783248364925, 
Instance 4 Run Time (total): 439.33470640331507
2024/08/26 21:37:19 models.runner_utils: 
Average cost  : 19.736417057198096 +/- 3.8651594122384556, 
Average cost-intern (Method)  : 19.957144908607006 +/- 0.0, 
Average PI: 2.1115920538131023 +/- 1.0914853630858254, 
Average WRAP: None +/- None, 
Average Run Time (best sol found): 19.675442069696146 +/- 33.94542942334531, 
Average Run Time (total): 439.33273351848766 +/- 0.018426941689267944
2024/08/26 21:37:19 models.runner_utils: CPU Specs: cpu_name: Intel(R) Xeon(R) CPU E5-1660 v4 @ 3.20GHz, threads_per_cpu: 2, total_cores: 8
2024/08/26 21:37:19 models.runner_utils: Storing Results of run 1 in /home/thyssens/RA/routing-arena/outputs/cvrp_200_explosion/val/BQ/2024-08-26_19-36-46/logs/
2024/08/26 21:37:19 models.runners: running inference 2/3...
2024/08/26 21:37:19 models.runners: Run-time dependent parameters: cuda Device (threads: 8), Adjusted Time Budget for construction: 410.0 / instance. Adjusted Time Budget for LS: 439.0 / instance.
2024/08/26 21:37:19 models.runners: running test inference for BQ_greedy with additional LS: SA...
2024/08/26 21:40:07 models.runners: Constructed solutions with average cost 19.957144908607006 in 1.314943566918373/inst
2024/08/26 21:40:07 models.runners: 
 finished construction... starting LS
2024/08/26 21:40:07 models.or_tools.or_tools: Working with original capacity and demand
2024/08/26 21:40:23 models.or_tools.or_tools: Local Search has remaining 436.3730078022927 seconds per instance.
2024/08/26 23:36:58 models.runners: Starting Evaluation for run 2/3 with time limit 480 for BQ_greedy_SA
2024/08/26 23:37:34 models.runner_utils: Stats for run 2/3:
2024/08/26 23:37:34 models.runner_utils: =================================
2024/08/26 23:37:34 models.runner_utils: 
Instance 0 Cost: 17.488182973282505, 
Instance 0 Method Internal-Cost: 17.728832244873047, 
Instance 0 PI: 3.530370171716135, 
Instance 0 WRAP: None, 
Instance 0 Run Time (best sol found): 14.703721990808845, 
Instance 0 Run Time (total): 438.3345343824476
2024/08/26 23:37:34 models.runner_utils: 
Instance 1 Cost: 23.204663815641336, 
Instance 1 Method Internal-Cost: 23.3670597076416, 
Instance 1 PI: 2.0953234322125924, 
Instance 1 WRAP: None, 
Instance 1 Run Time (best sol found): 6.668056035414338, 
Instance 1 Run Time (total): 438.3571374565363
2024/08/26 23:37:34 models.runner_utils: 
Instance 2 Cost: 22.505101531100568, 
Instance 2 Method Internal-Cost: 22.657604217529297, 
Instance 2 PI: 1.053796909461302, 
Instance 2 WRAP: None, 
Instance 2 Run Time (best sol found): 4.482590219005942, 
Instance 2 Run Time (total): 438.3388289157301
2024/08/26 23:37:34 models.runner_utils: 
Instance 3 Cost: 22.154942061320696, 
Instance 3 Method Internal-Cost: 22.333023071289062, 
Instance 3 PI: 1.8984559512095878, 
Instance 3 WRAP: None, 
Instance 3 Run Time (best sol found): 7.173703107982874, 
Instance 3 Run Time (total): 438.3325792104006
2024/08/26 23:37:34 models.runner_utils: 
Instance 4 Cost: 17.18219963267425, 
Instance 4 Method Internal-Cost: 17.19955062866211, 
Instance 4 PI: 1.4042214855350288, 
Instance 4 WRAP: None, 
Instance 4 Run Time (best sol found): 5.939620267599821, 
Instance 4 Run Time (total): 438.33868014626205
2024/08/26 23:37:34 models.runner_utils: 
Average cost  : 19.736417057198096 +/- 3.8651594122384556, 
Average cost-intern (Method)  : 19.957144908607006 +/- 0.0, 
Average PI: 2.1116360802958405 +/- 1.0914888281870365, 
Average WRAP: None +/- None, 
Average Run Time (best sol found): 19.643050096856314 +/- 33.826779033161614, 
Average Run Time (total): 438.3290212578286 +/- 0.0314966808126208
2024/08/26 23:37:34 models.runner_utils: CPU Specs: cpu_name: Intel(R) Xeon(R) CPU E5-1660 v4 @ 3.20GHz, threads_per_cpu: 2, total_cores: 8
2024/08/26 23:37:34 models.runner_utils: Storing Results of run 2 in /home/thyssens/RA/routing-arena/outputs/cvrp_200_explosion/val/BQ/2024-08-26_19-36-46/logs/
2024/08/26 23:37:34 models.runners: running inference 3/3...
2024/08/26 23:37:34 models.runners: Run-time dependent parameters: cuda Device (threads: 8), Adjusted Time Budget for construction: 410.0 / instance. Adjusted Time Budget for LS: 439.0 / instance.
2024/08/26 23:37:34 models.runners: running test inference for BQ_greedy with additional LS: SA...
2024/08/26 23:40:23 models.runners: Constructed solutions with average cost 19.957144908607006 in 1.3188416175544262/inst
2024/08/26 23:40:23 models.runners: 
 finished construction... starting LS
2024/08/26 23:40:23 models.or_tools.or_tools: Working with original capacity and demand
2024/08/26 23:40:39 models.or_tools.or_tools: Local Search has remaining 435.0541661847383 seconds per instance.
2024/08/27 01:36:58 models.runners: Starting Evaluation for run 3/3 with time limit 480 for BQ_greedy_SA
2024/08/27 01:37:34 models.runner_utils: Stats for run 3/3:
2024/08/27 01:37:34 models.runner_utils: =================================
2024/08/27 01:37:34 models.runner_utils: 
Instance 0 Cost: 17.488182973282505, 
Instance 0 Method Internal-Cost: 17.728832244873047, 
Instance 0 PI: 3.530467452548214, 
Instance 0 WRAP: None, 
Instance 0 Run Time (best sol found): 14.907153837382793, 
Instance 0 Run Time (total): 437.33425915800035
2024/08/27 01:37:34 models.runner_utils: 
Instance 1 Cost: 23.204663815641336, 
Instance 1 Method Internal-Cost: 23.3670597076416, 
Instance 1 PI: 2.0953833183782855, 
Instance 1 WRAP: None, 
Instance 1 Run Time (best sol found): 6.6716768108308315, 
Instance 1 Run Time (total): 437.3336372319609
2024/08/27 01:37:34 models.runner_utils: 
Instance 2 Cost: 22.505101531100568, 
Instance 2 Method Internal-Cost: 22.657604217529297, 
Instance 2 PI: 1.0538712355346647, 
Instance 2 WRAP: None, 
Instance 2 Run Time (best sol found): 4.488298399373889, 
Instance 2 Run Time (total): 437.35884199663997
2024/08/27 01:37:34 models.runner_utils: 
Instance 3 Cost: 22.154942061320696, 
Instance 3 Method Internal-Cost: 22.333023071289062, 
Instance 3 PI: 1.8985585392450766, 
Instance 3 WRAP: None, 
Instance 3 Run Time (best sol found): 7.231688531115651, 
Instance 3 Run Time (total): 437.3559247851372
2024/08/27 01:37:34 models.runner_utils: 
Instance 4 Cost: 17.18219963267425, 
Instance 4 Method Internal-Cost: 17.19955062866211, 
Instance 4 PI: 1.4042923857356282, 
Instance 4 WRAP: None, 
Instance 4 Run Time (best sol found): 5.933213917538524, 
Instance 4 Run Time (total): 437.3423739541322
2024/08/27 01:37:34 models.runner_utils: 
Average cost  : 19.736417057198096 +/- 3.8651594122384556, 
Average cost-intern (Method)  : 19.957144908607006 +/- 0.0, 
Average PI: 2.1117166395874363 +/- 1.0914675826167293, 
Average WRAP: None +/- None, 
Average Run Time (best sol found): 19.681952304352308 +/- 33.88328205205281, 
Average Run Time (total): 437.33305674951407 +/- 0.04458077943421641
2024/08/27 01:37:34 models.runner_utils: CPU Specs: cpu_name: Intel(R) Xeon(R) CPU E5-1660 v4 @ 3.20GHz, threads_per_cpu: 2, total_cores: 8
2024/08/27 01:37:34 models.runner_utils: Storing Results of run 3 in /home/thyssens/RA/routing-arena/outputs/cvrp_200_explosion/val/BQ/2024-08-26_19-36-46/logs/
2024/08/27 01:37:34 models.runner_utils: 

Summary Stats of the 3 Runs: 

Average Obj. Costs over 3 Runs: 19.736417057198096
Std. Dev. of Avg Costs over 3 Runs: 0.0
Average PI Score over 3 Runs: 2.111648257898793
Average WRAP Score over 3 Runs: None
Average Runtime (until best cost found) over 3 Runs: 19.666814823634923
Average Total Runtime of method over 3 Runs: 438.33160384194343
2024/08/27 01:37:34 models.runners: Storing Overall Results for 3 runs in /home/thyssens/RA/routing-arena/outputs/cvrp_200_explosion/val/BQ/2024-08-26_19-36-46/logs/
